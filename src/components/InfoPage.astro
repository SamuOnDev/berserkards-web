---
import SiteLayout from "../layouts/SiteLayout.astro";
import TopTrustBar from "./TopTrustBar.astro";
import Header from "./Header.astro";
import Footer from "./Footer.astro";
import { defaultLocale, translations, type Locale } from "../i18n";

const { lang, pageKey, slug } = Astro.props as {
  lang: Locale;
  pageKey: "shippingReturns" | "faqs" | "terms";
  slug: string;
};

const messages = translations[lang];
const page = messages.pages[pageKey];
const basePath = lang === defaultLocale ? "" : `/${lang}`;
const switchLang = lang === "es" ? "en" : "es";
const switchPath = switchLang === defaultLocale ? `/${slug}` : `/${switchLang}/${slug}`;
---

<SiteLayout title={`${messages.meta.title} | ${page.title}`} lang={lang}>
  <TopTrustBar />
  <Header
    messages={messages}
    basePath={basePath}
    switchLang={switchLang}
    switchPath={switchPath}
  />
  <main class="mx-auto max-w-5xl px-4 py-12">
    <div class="rounded-3xl border border-border bg-surface/70 px-6 py-10 sm:px-10">
      <p class="text-xs uppercase tracking-[0.3em] text-muted">{page.kicker}</p>
      <h1 class="mt-4 text-3xl font-semibold sm:text-4xl">{page.title}</h1>
      <p class="mt-4 max-w-2xl text-sm text-muted">{page.subtitle}</p>

      {page.notice && (
        <div class="mt-6 rounded-2xl border border-border/70 bg-base/80 px-4 py-4 text-xs text-muted sm:px-6">
          {page.notice}
        </div>
      )}
    </div>

    {page.sections && (
      <div class="mt-10 grid gap-6 lg:grid-cols-2">
        {page.sections.map((section) => (
          <div class="rounded-2xl border border-border bg-surface/70 p-6">
            <h2 class="text-lg font-semibold">{section.title}</h2>
            <p class="mt-3 text-sm text-muted">{section.body}</p>
            {section.items && (
              <ul class="mt-4 space-y-2 text-sm text-muted">
                {section.items.map((item) => (
                  <li class="flex gap-2">
                    <span class="mt-1 h-1.5 w-1.5 rounded-full bg-accent"></span>
                    <span>{item}</span>
                  </li>
                ))}
              </ul>
            )}
          </div>
        ))}
      </div>
    )}

    {page.faqs && (
      <div class="mt-10 space-y-4">
        {page.faqs.map((faq) => (
          <div class="rounded-2xl border border-border bg-surface/70 p-6">
            <h2 class="text-base font-semibold">{faq.question}</h2>
            <p class="mt-3 text-sm text-muted">{faq.answer}</p>
          </div>
        ))}
      </div>
    )}

    {page.cta && (
      <div class="mt-10 rounded-2xl border border-border bg-base/80 px-6 py-6">
        <h2 class="text-lg font-semibold">{page.cta.title}</h2>
        <p class="mt-2 text-sm text-muted">{page.cta.body}</p>
        <a class="mt-4 inline-flex text-xs font-semibold text-accent" href={`mailto:${page.cta.email}`}>
          {page.cta.email}
        </a>
      </div>
    )}
  </main>

  <Footer messages={messages} basePath={basePath} />
</SiteLayout>
